{"version":3,"file":"AuthenticatorEnrollOptionsContainer.js","sources":["../../../../../../src/v2/view-builder/components/AuthenticatorEnrollOptionsContainer.js"],"sourcesContent":["/*!\n * Copyright (c) 2020, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *\n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { loc, View, Collection } from '@okta/courage';\nimport { FORMS as RemediationForms } from '../../ion/RemediationConstants';\nimport AuthenticatorEnrollOptions from './AuthenticatorEnrollOptions';\nimport remindMeLater from './RemindMeLaterButton';\nimport skipAll from './SkipOptionalEnrollmentButton';\n\nexport default View.extend({\n\n  className: 'authenticator-enroll-list-container',\n\n  initialize: function() {\n    const authenticatorsWithGracePeriod = [];\n    const authenticators = [];\n\n    this.options.optionItems.forEach((authenticator) => {\n      if (authenticator.relatesTo?.gracePeriod?.expiry\n        && new Date(authenticator.relatesTo?.gracePeriod?.expiry).getTime() > Date.now()) {\n        authenticatorsWithGracePeriod.push(authenticator);\n      } else {\n        authenticators.push(authenticator);\n      }\n    });\n\n    this.hasSkipRemediation = !!this.options.appState.hasRemediationObject(RemediationForms?.SKIP);\n    this.hasOnlyOptional = this.hasSkipRemediation && authenticatorsWithGracePeriod?.length === 0;\n    this.hasOnlyGracePeriod =  this.hasSkipRemediation &&\n      this.options.optionItems?.length === authenticatorsWithGracePeriod?.length;\n\n    if (authenticators.length) {\n      this.add(new AuthenticatorEnrollOptions({\n        ...this.options,\n        collection: new Collection(authenticators),\n        optionItems: authenticators,\n        listTitle: this.hasOnlyOptional\n          ? loc('oie.setup.optional.short', 'login') : loc('oie.setup.required.now', 'login'),\n      }));\n    }\n    if (authenticatorsWithGracePeriod.length) {\n      this.add(new AuthenticatorEnrollOptions({\n        ...this.options,\n        collection: new Collection(authenticatorsWithGracePeriod),\n        optionItems: authenticatorsWithGracePeriod,\n        listTitle: loc('oie.setup.required.soon', 'login'),\n        listSubtitle: loc('oie.setup.required.soon.description', 'login'),\n      }));\n    }\n\n    if (this.hasOnlyGracePeriod) {\n      this.add(remindMeLater);\n    } else if (this.hasOnlyOptional) {\n      this.add(skipAll);\n    }\n  },\n});\n"],"names":["View","extend","className","initialize","authenticatorsWithGracePeriod","authenticators","options","optionItems","forEach","authenticator","relatesTo","gracePeriod","expiry","Date","getTime","now","push","hasSkipRemediation","appState","hasRemediationObject","RemediationForms","SKIP","hasOnlyOptional","length","hasOnlyGracePeriod","add","AuthenticatorEnrollOptions","collection","Collection","listTitle","loc","listSubtitle","remindMeLater","skipAll"],"mappings":"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"}