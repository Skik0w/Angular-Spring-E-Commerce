{"version":3,"file":"SameDeviceEnrollLink.js","sources":["../../../../../../../src/v2/view-builder/views/ov/SameDeviceEnrollLink.js"],"sourcesContent":["import { View } from '@okta/courage';\nimport hbs from '@okta/handlebars-inline-precompile';\nimport { FORMS as RemediationForms } from '../../../ion/RemediationConstants';\n\nexport default View.extend({\n  className: 'ov-same-device-enroll-text',\n  template: hbs `\n        {{{i18n code=\"oie.enroll.okta_verify.select.channel.ovOnThisDevice\"\n        bundle=\"login\" $1=\"<a class='ov-same-device-enroll-link' href='#'>$1</a>\"}}}\n      `,\n  postRender: function() {\n    const appState = this.options && this.options.appState;\n    const model = this.model;\n\n    this.$('.ov-same-device-enroll-link').click(function() {\n      if (!appState || !model) {\n        return;\n      }\n\n      const sameDeviceChannel = 'samedevice';\n      const remediations = appState.get('remediations');\n      const selectEnrollmentChannelRemediation = remediations.find((remediation) => {\n        return remediation.name === RemediationForms.SELECT_ENROLLMENT_CHANNEL;\n      });\n\n      if (!selectEnrollmentChannelRemediation) {\n        return;\n      }\n      const idField = selectEnrollmentChannelRemediation.uiSchema?.find((schema) =>\n        schema.name === 'authenticator.id');\n      if (!idField) {\n        return;\n      }\n      // filter selected channel\n      const sameDeviceChannelField = selectEnrollmentChannelRemediation.uiSchema?.find((schema) =>\n        schema.name === 'authenticator.channel');\n      if (!sameDeviceChannelField) {\n        return;\n      }\n      sameDeviceChannelField.options = sameDeviceChannelField.options?.filter((option) =>\n        option.value === sameDeviceChannel);\n      sameDeviceChannelField.value = sameDeviceChannelField.options[0]?.value || sameDeviceChannel;\n      sameDeviceChannelField.sublabel = null;\n\n      model.set('authenticator.channel', sameDeviceChannelField.value);\n      model.set('authenticator.id', idField.value);\n      model.set('formName', selectEnrollmentChannelRemediation.name);\n      appState.trigger('saveForm', model);\n    });\n  },\n});\n"],"names":["View","extend","className","template","postRender","appState","options","model","$","click","sameDeviceChannel","remediations","get","selectEnrollmentChannelRemediation","find","remediation","name","RemediationForms","SELECT_ENROLLMENT_CHANNEL","idField","uiSchema","schema","sameDeviceChannelField","filter","option","value","sublabel","set","trigger"],"mappings":"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"}