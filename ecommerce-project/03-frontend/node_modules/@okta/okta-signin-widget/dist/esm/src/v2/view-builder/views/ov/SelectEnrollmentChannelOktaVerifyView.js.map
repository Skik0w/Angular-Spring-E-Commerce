{"version":3,"file":"SelectEnrollmentChannelOktaVerifyView.js","sources":["../../../../../../../src/v2/view-builder/views/ov/SelectEnrollmentChannelOktaVerifyView.js"],"sourcesContent":["import { loc, _ } from '@okta/courage';\nimport { BaseForm } from '../../internals';\nimport BaseAuthenticatorView from '../../components/BaseAuthenticatorView';\nimport BrowserFeatures from '../../../../util/BrowserFeatures';\nimport SameDeviceEnrollLink from './SameDeviceEnrollLink';\n\nconst Body = BaseForm.extend({\n  title() {\n    return (BrowserFeatures.isAndroid() || BrowserFeatures.isIOS())\n      ? loc('oie.enroll.okta_verify.setup.title', 'login')\n      : loc('oie.enroll.okta_verify.select.channel.title.updated', 'login');\n  },\n  getUISchema() {\n    const schemas = BaseForm.prototype.getUISchema.apply(this, arguments);\n    // filter selected channel\n    const channelField = _.find(schemas, (schema) => schema.name === 'authenticator.channel');\n    // do not show the 'samedevice' radio option, that option is displayed as a link instead\n    channelField.options = _.filter(channelField?.options, (option) => (\n      option.value !== this.options.appState.get('currentAuthenticator')?.contextualData?.selectedChannel\n      && option.value !== 'samedevice'\n    ));\n    channelField.value = channelField.options[0]?.value;\n    channelField.sublabel = null;\n    this.model.set('authenticator.channel', channelField.value);\n    const description = {\n      View: loc('oie.enroll.okta_verify.select.channel.subtitle', 'login'),\n      selector: '.o-form-fieldset-container',\n    };\n    return [description, ...schemas];\n  },\n});\n\nexport default BaseAuthenticatorView.extend({\n  Body,\n  postRender() {\n    const authenticatorFormValues = this.options.currentViewState.value\n      ?.find(val => val.name === 'authenticator').value.form.value;\n    const sameDeviceChannelAvailable = authenticatorFormValues\n      ?.find(val => val.name === 'channel').options?.find(channel => channel.value === 'samedevice');\n    // only add this link if the samedevice channel is available in the remediation\n    if (sameDeviceChannelAvailable) {\n      this.add(new SameDeviceEnrollLink({\n        model: this.model,\n        settings: this.settings,\n        appState: this.options.appState\n      }), 'form');\n    }\n  },\n});\n"],"names":["Body","BaseForm","extend","title","BrowserFeatures","isAndroid","isIOS","loc","getUISchema","schemas","prototype","apply","arguments","channelField","_","find","schema","name","options","filter","option","value","appState","get","contextualData","selectedChannel","sublabel","model","set","description","View","selector","BaseAuthenticatorView","postRender","authenticatorFormValues","currentViewState","val","form","sameDeviceChannelAvailable","channel","add","SameDeviceEnrollLink","settings"],"mappings":"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"}